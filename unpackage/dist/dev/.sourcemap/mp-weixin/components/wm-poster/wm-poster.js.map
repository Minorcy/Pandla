{"version":3,"sources":["webpack:///E:/Project/HBuilderProjects/Pandla/components/wm-poster/wm-poster.vue","webpack:///E:/Project/HBuilderProjects/Pandla/components/wm-poster/wm-poster.vue?af36","webpack:///E:/Project/HBuilderProjects/Pandla/components/wm-poster/wm-poster.vue?1e44","webpack:///E:/Project/HBuilderProjects/Pandla/components/wm-poster/wm-poster.vue?3d6d","webpack:///E:/Project/HBuilderProjects/Pandla/components/wm-poster/wm-poster.vue?3e4d"],"names":["_this","name","props","CanvasID","Type","String","default","imgSrc","QrSrc","Title","TitleColor","LineType","Boolean","PriceTxt","PriceColor","OriginalTxt","OriginalColor","Width","CanvasBg","Referrer","ViewDetails","data","canvasW","canvasH","canvasImgSrc","ctx","methods","OnCanvas","uni","showLoading","title","createCanvasContext","C_W","upx2px","C_P","C_Q","_strlineW","getImageInfo","_imgInfo","_QrCode","r","width","height","q","imgW","Math","floor","setFillStyle","fillRect","drawImage","path","setFontSize","_strLastIndex","_strHeight","_num","i","length","measureText","fillText","substring","strokeStyle","moveTo","lineTo","stroke","setTimeout","draw","ret","getNewImage","Promise","resolve","errs","src","success","image","fail","err","canvasToTempFilePath","canvasId","quality","complete","res","hideLoading","$emit","mounted"],"mappings":"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","file":"components/wm-poster/wm-poster.js","sourcesContent":["//\n//\n//\n//\n//\n//\n\n\tvar _this;\nexport default {\n\tname: 'wm-poster',\n\tprops: {\n\t\tCanvasID:{\t\t//CanvasID 等同于 canvas-id\n\t\t\tType:String,\n\t\t\tdefault:'PosterCanvas'\n\t\t},\n\t\timgSrc:{\t\t//展示图\n\t\t\tType:String,\n\t\t\tdefault:''\n\t\t},\n\t\tQrSrc:{\t\t\t//二维码\n\t\t\tType:String,\n\t\t\tdefault:''\n\t\t},\n\t\tTitle:{\t\t\t//文本内容\n\t\t\tType:String,\n\t\t\tdefault:''\n\t\t},\n\t\tTitleColor:{\t//标题颜色\n\t\t\tType:String,\n\t\t\tdefault:'#333333'\n\t\t},\n\t\tLineType:{\t\t//标题显示行数\t\t（注超出2行显示会导致画布布局絮乱）\n\t\t\tType:[String,Boolean],\n\t\t\tdefault:true\n\t\t},\n\t\tPriceTxt:{\t\t//价格值\n\t\t\tType:String,\n\t\t\tdefault:'99.99'\n\t\t},\n\t\tPriceColor:{\t//价格颜色\n\t\t\tType:String,\n\t\t\tdefault:'#000000'\n\t\t},\n\t\tOriginalTxt:{\t//原价值\n\t\t\tType:String,\n\t\t\tdefault:''\n\t\t},\n\t\tOriginalColor:{\t//默认颜色（如原价与扫描二维码颜色）\n\t\t\tType:String,\n\t\t\tdefault:'#b8b8b8'\n\t\t},\n\t\tWidth:{\t\t\t//画布宽度  (高度根据图片比例计算 单位upx)\n\t\t\tType:String,\n\t\t\tdefault:750\n\t\t},\n\t\tCanvasBg:{\t\t//canvas画布背景色\n\t\t\tType:String,\t\t\n\t\t\tdefault:'#ffffff'\n\t\t},\n\t\tReferrer:{\t\t//推荐人信息\n\t\t\tType:String,\n\t\t\tdefault:'潘多拉星球内測1.0歡迎您'\n\t\t},\n\t\tViewDetails:{\t//描述提示文字\n\t\t\tType:String,\n\t\t\tdefault:'长按或扫描识别二维码'\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tcanvasW:0,\n\t\t\tcanvasH: 0,\n\t\t\tcanvasImgSrc:'',\n\t\t\tctx:null\n\t\t};\n\t},\n\tmethods: {\n\t\tasync OnCanvas() {\n\t\t\tuni.showLoading({\n\t\t\t\ttitle: '生成海報中'\n\t\t\t});\n\t\t\t_this.ctx = uni.createCanvasContext(_this.CanvasID,this);\n\t\t\tconst C_W = uni.upx2px(_this.Width), //canvas宽度\n\t\t\t\tC_P = uni.upx2px(30), //canvas Paddng 间距\n\t\t\t\tC_Q = uni.upx2px(200); //二维码或太阳码宽高\n\t\t\tlet _strlineW = 0; //文本宽度\n\t\t\tlet _imgInfo = await _this.getImageInfo({ imgSrc: _this.imgSrc }); //广告图\n\t\t\tlet _QrCode = await _this.getImageInfo({ imgSrc: _this.QrSrc }); //二维码或太阳码\n\t\t\tlet r = [_imgInfo.width, _imgInfo.height];\n\t\t\tlet q = [_QrCode.width, _QrCode.height];\n\t\t\tlet imgW = C_W - C_P * 2;\n\t\t\tif (r[0] != imgW) {\n\t\t\t\tr[1] = Math.floor((imgW / r[0]) * r[1]);\n\t\t\t\tr[0] = imgW;\n\t\t\t}\n\t\t\tif (q[0] != C_Q) {\n\t\t\t\tq[1] = Math.floor((C_Q / q[0]) * q[1]);\n\t\t\t\tq[0] = C_Q;\n\t\t\t}\n\t\t\t_this.canvasW = C_W;\n\t\t\t_this.canvasH = r[1] + q[1] + 28;\n\t\t\t_this.ctx.setFillStyle(_this.CanvasBg); //canvas背景颜色\n\t\t\t_this.ctx.fillRect(0, 0, C_W, _this.canvasH); //canvas画布大小\n\t\t\t\n\t\t\t//添加图片展示\n\t\t\t_this.ctx.drawImage(_imgInfo.path, C_P, C_P, r[0], r[1]);\n\t\t\t//添加图片展示 end\n\n\t\t\t//设置文本\n\t\t\t_this.ctx.setFontSize(uni.upx2px(30)); //设置标题字体大小\n\t\t\t_this.ctx.setFillStyle(_this.TitleColor); //设置标题文本颜色\n\t\t\tlet _strLastIndex = 0; //每次开始截取的字符串的索引\n\t\t\tlet _strHeight = r[1] + C_P * 2 + 10; //绘制字体距离canvas顶部的初始高度\n\t\t\tlet _num=1;\n\t\t\tfor (let i = 0; i < _this.Title.length; i++) {\n\t\t\t\t_strlineW += _this.ctx.measureText(_this.Title[i]).width;\n\t\t\t\tif (_strlineW > r[0]) {\n\t\t\t\t\tif(_num == 2&&_this.LineType){\n\t\t\t\t\t\t//文字换行数量大于二进行省略号处理\n\t\t\t\t\t\t_this.ctx.fillText(_this.Title.substring(_strLastIndex, i-8)+'...', C_P, _strHeight);\n\t\t\t\t\t\t_strlineW = 0;\n\t\t\t\t\t\t_strLastIndex = i;\n\t\t\t\t\t\t_num++;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else{\n\t\t\t\t\t\t_this.ctx.fillText(_this.Title.substring(_strLastIndex, i), C_P, _strHeight);\n\t\t\t\t\t\t_strlineW = 0;\n\t\t\t\t\t\t_strHeight += 20;\n\t\t\t\t\t\t_strLastIndex = i;\n\t\t\t\t\t\t_num++;\n\t\t\t\t\t}\n\t\t\t\t}else if (i == _this.Title.length - 1) {\n\t\t\t\t\t_this.ctx.fillText(_this.Title.substring(_strLastIndex, i + 1), C_P, _strHeight + uni.upx2px(70));\n\t\t\t\t\t_strlineW = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\t//设置文本 end\n\n\t\t\t//设置价格\n\t\t\t_strlineW = C_P;\n\t\t\t_strHeight += uni.upx2px(20);\n\t\t\t// if(_num==1){\n\t\t\t// \t_strHeight += 20;\t//单行标题时占位符\n\t\t\t// }\n\t\t\t\n\t\t\tif(_this.PriceTxt !=''){\t//判断是否有销售价格\n\t\t\t\t_this.ctx.setFillStyle(_this.PriceColor);\n\t\t\t\t_this.ctx.setFontSize(uni.upx2px(38));\n\t\t\t\t_this.ctx.fillText(_this.PriceTxt, _strlineW, _strHeight); //商品价格\n\t\t\t\t_strlineW += _this.ctx.measureText(_this.PriceTxt).width + uni.upx2px(10);\n\t\t\t}\n\t\t\tif(_this.PriceTxt !='' && _this.OriginalTxt !=''){\t//判断是否有销售价格且原价\n\t\t\t\t_this.ctx.setFillStyle(_this.OriginalColor);\n\t\t\t\t_this.ctx.setFontSize(uni.upx2px(24));\n\t\t\t\t_this.ctx.fillText(_this.OriginalTxt, _strlineW, _strHeight); //商品原价\n\t\t\t}\n\t\t\t_this.ctx.strokeStyle = _this.OriginalColor;\n\t\t\t_this.ctx.moveTo(_strlineW, _strHeight - uni.upx2px(10)); //起点\n\t\t\t_this.ctx.lineTo(_strlineW + _this.ctx.measureText(_this.OriginalTxt).width, _strHeight - uni.upx2px(10)); //终点\n\t\t\t_this.ctx.stroke();\n\t\t\t//设置价格 end\n\n\t\t\t//添加二维码\n\t\t\t_strHeight -= uni.upx2px(50);\n\t\t\t_this.ctx.drawImage(_QrCode.path, r[0] - q[0] + C_P, _strHeight, q[0], q[1]);\n\t\t\t//添加二维码 end\n\n\t\t\t//添加推荐人与描述\n\t\t\t_this.ctx.setFillStyle(_this.TitleColor);\n\t\t\t_this.ctx.setFillStyle(_this.OriginalColor);\n\t\t\t_this.ctx.setFontSize(uni.upx2px(24));\n\t\t\t_this.ctx.fillText(_this.Referrer, C_P, _strHeight + uni.upx2px(50) + q[1] / 2);\n\t\t\t_this.ctx.setFillStyle(_this.OriginalColor);\n\t\t\t_this.ctx.setFontSize(uni.upx2px(24));\n\t\t\t_this.ctx.fillText(_this.ViewDetails, C_P, _strHeight + uni.upx2px(50) + q[1] / 2 + 20);\n\t\t\t//添加推荐人与描述 end\n\t\t\t\n\t\t\t//延迟后渲染至canvas上\n\t\t\tsetTimeout(function() {\n\t\t\t\t_this.ctx.draw(true,(ret)=>{\n\t\t\t\t\t_this.getNewImage();\n\t\t\t\t});\n\t\t\t}, 600);\n\t\t},\n\t\tasync getImageInfo({ imgSrc }) {\n\t\t\treturn new Promise((resolve, errs) => {\n\t\t\t\tuni.getImageInfo({\n\t\t\t\t\tsrc: imgSrc,\n\t\t\t\t\tsuccess: function(image) {\n\t\t\t\t\t\tresolve(image);\n\t\t\t\t\t},\n\t\t\t\t\tfail(err) {\n\t\t\t\t\t\terrs(err);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tgetNewImage(){\n\t\t\tuni.canvasToTempFilePath({\n\t\t\t\tcanvasId: _this.CanvasID,\n\t\t\t\tquality: 1,\n\t\t\t\tcomplete: (res) => {\n\t\t\t\t\t// console.log(res.tempFilePath);\n\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t_this.$emit('success',res);\n\t\t\t\t}\n\t\t\t},this);\n\t\t}\n\t\t\n\t},\n\tmounted() {\n\t\t_this = this;\n\t\t_this.OnCanvas();\n\t}\n};\n","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./wm-poster.vue?vue&type=template&id=7c5eec63&\"\nimport script from \"./wm-poster.vue?vue&type=script&lang=js&\"\nexport * from \"./wm-poster.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!C:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"C:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('7c5eec63', component.options)\n    } else {\n      api.reload('7c5eec63', component.options)\n    }\n    module.hot.accept(\"./wm-poster.vue?vue&type=template&id=7c5eec63&\", function () {\n      api.rerender('7c5eec63', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"E:/Project/HBuilderProjects/Pandla/components/wm-poster/wm-poster.vue\"\nexport default component.exports","import mod from \"-!C:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!C:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!./wm-poster.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!C:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!C:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!./wm-poster.vue?vue&type=script&lang=js&\"","export * from \"-!C:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!C:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!C:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!C:\\\\IDE\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!./wm-poster.vue?vue&type=template&id=7c5eec63&\""],"sourceRoot":""}