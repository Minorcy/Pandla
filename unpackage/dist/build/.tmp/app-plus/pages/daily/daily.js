(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/daily/daily"],{"0c1c":function(t,n,i){"use strict";var e=i("eff3"),o=i.n(e);o.a},"528f":function(t,n,i){"use strict";i.r(n);var e=i("c319"),o=i("c4b0");for(var a in o)"default"!==a&&function(t){i.d(n,t,function(){return o[t]})}(a);i("0c1c"),i("54a0");var s=i("2877"),c=Object(s["a"])(o["default"],e["a"],e["b"],!1,null,"84d3a146",null);n["default"]=c.exports},"54a0":function(t,n,i){"use strict";var e=i("d497"),o=i.n(e);o.a},"8fd3":function(t,n,i){"use strict";(function(t){i("274e"),i("921b");e(i("66fd"));var n=e(i("528f"));function e(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,i("6e42")["createPage"])},b946:function(t,n,i){"use strict";(function(t,e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=s(i("d3df")),a=i("0be9");function s(t){return t&&t.__esModule?t:{default:t}}function c(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var l=function(){return i.e("components/chatinput").then(i.bind(null,"adfd"))},d=function(){return i.e("components/invinbg-image-cropper/invinbg-image-cropper").then(i.bind(null,"97b7"))},u={data:function(){return{currentIndex:0,dynInfo:"",uid:"",did:"",cid:"",index:"",likeNumber:0,animation:!1,showComment:!1,bulletList:[],doomm:!0,commCount:0,commentInfo:"",commplaceholder:"為保證用戶隱私，只可以看自己的評論",commContent:"",disabled:!1,addType:"",count:10,height:"60%",position:"absolute",flag:0,text:"",lastX:0,lastY:0,click:0,heartAnimation:{active:!1,top:"",left:"",display:!1},animationData:"",tempFilePath:""}},components:{chatInput:l,ImageCropper:d},methods:{heart:function(){},double:function(n){var i=this;if(this.click+=1,setTimeout(function(){i.click=0},350),2==this.click){console.log(t("双击",n," at pages\\daily\\daily.vue:173")),this.heartAnimation.display=!0,this.heartAnimation.top=n.detail.y-50,this.heartAnimation.left=n.detail.x-50;var e=wx.createAnimation({duration:400,timingFunction:"ease-out"});e.opacity(.6).scale(.6).step(),e.opacity(0).scale(.4).step(),this.animationData=e.export(),setTimeout(function(){i.heartAnimation.display=!1},1e3),console.log(t(this.dynInfo[this.index].isOwn,this.did,this.index," at pages\\daily\\daily.vue:191")),this.likePerson(this.dynInfo[this.index].isOwn,this.did,this.index)}},handletouchmove:function(t){if(0===this.flag){var n=t.touches[0].pageX,i=t.touches[0].pageY,o=n-this.lastX,a=i-this.lastY,s="";this.mindex=-1,Math.abs(o)>Math.abs(a)?o<0?(s="向左滑动",this.flag=1):o>30&&(s="向右滑动",e.switchTab({url:"/pages/main/main"}),this.flag=2):a<0?(s="向上滑动",this.flag=3):a>0&&(s="向下滑动",this.flag=4),this.lastX=n,this.lastY=i,this.text=s}},handletouchstart:function(t){this.lastX=t.touches[0].pageX,this.lastY=t.touches[0].pageY},handletouchend:function(t){this.flag=0,this.text="没有滑动"},blur:function(){this.height="60%",this.position="absolute"},focus:function(){this.height="30%",this.position="fixed"},transitioning:function(){},toMap:function(n,i,o){""==n&&""==i&&""==o||e.openLocation({latitude:Number(n),longitude:Number(i),name:o,success:function(n){console.log(t(n," at pages\\daily\\daily.vue:275"))}})},findDyn:function(){var t=this;(0,a.findAllDyn)(0).then(function(n){t.dynInfo=n,t.uid=n[0].uid,t.index=0,t.did=n[0].id,t.getAllBullet()})},loadFindDyn:function(){var t=this;(0,a.findAllDyn)(this.count).then(function(n){t.count+=n.length,t.dynInfo=t.dynInfo.concat(n),0==n.length&&e.showToast({icon:"none",title:"没有更多数据了"})})},userFollow:function(t,n){var i=this;(0,a.concern)(1,t).then(function(t){i.dynInfo[n].following=1})},userInfo:function(t){e.navigateTo({url:"/pages/daily/userInfo?uid="+t})},likePerson:function(n,i,o){var s=this;console.log(t(n,i,o," at pages\\daily\\daily.vue:313")),1==n?e.showToast({icon:"none",title:"不可以給自己點贊哦"}):(this.likeNumber++,(0,a.like)(i,1).then(function(t){s.animation=!0,(0,a.likeCount)(i).then(function(t){s.dynInfo[o].isLike=1,s.dynInfo[o].like_count=t,s.dynInfo[o].pan=t/10,e.showToast({icon:"none",title:"點贊了"+s.likeNumber+"次"})})}),this.animation=!1)},getAllBullet:function(){var t=this;this.bulletList=[],(0,a.getBullet)(this.did).then(function(n){var e=n.content.length;if(0!=e)for(var o=0;o<e;o++)t.bulletList.push(new i(n.content[o],parseInt(500*Math.random(),10),Math.ceil(8*Math.random()+3)))});var n=0,i=function t(i,e,o,a){c(this,t),this.text=i,this.top=e,this.time=o,this.display=!0,this.id=n++}},showDoomm:function(){1==this.doomm?this.doomm=!1:this.doomm=!0},showComm:function(t){var n=this;1==this.showComment?this.showComment=!1:this.showComment=!0,(0,a.getComment)(t).then(function(t){n.commentInfo=t,n.commCount=t.length})},hidComm:function(){1==this.showComment?this.showComment=!1:this.showComment=!0,this.commentInfo="",this.commCount=0,this.commContent="",this.disabled=!1},replyComm:function(t,n,i){i!=e.getStorageSync("USERS_KEY").id?(this.commplaceholder="@"+n,this.addType="reply",this.cid=t):e.showToast({icon:"none",title:"不能自己回復自己哦"})},addComm:function(){var n=this;this.disabled=!0,""!=this.commContent&&("reply"==this.addType?(console.log(t("刚刚是回复"," at pages\\daily\\daily.vue:405")),(0,a.reply)(this.cid,this.commContent).then(function(t){if(null==t)return e.showToast({icon:"none",title:"只能回復一次哦"}),n.addType="",n.commContent="",n.commplaceholder="為保證用戶隱私，只可以看自己的評論",void(n.disabled=!1);(0,a.getComment)(n.did).then(function(t){n.commentInfo=t,n.addType="",n.commContent="",n.commplaceholder="為保證用戶隱私，只可以看自己的評論",n.disabled=!1,n.commCount=t.length,n.dynInfo[n.index].com_count=t.length})})):(console.log(t("刚刚是評論"," at pages\\daily\\daily.vue:430")),(0,a.addComment)(this.commContent,this.did).then(function(t){(0,a.getComment)(n.did).then(function(t){n.commentInfo=t,n.commCount=t.length,n.commContent="",n.addType="",n.commplaceholder="為保證用戶隱私，只可以看自己的評論",n.disabled=!1,n.dynInfo[n.index].com_count=t.length}),n.getAllBullet()}))),e.hideKeyboard()},publishDyn:function(){var t=this;(0,a.getImgTemp)().then(function(n){t.tempFilePath=n})},confirm:function(t){this.tempFilePath="",this.$store.commit("setImgTemp",t.detail.tempFilePath),e.navigateTo({url:"publish"})},cancel:function(){this.tempFilePath=""},moveHandle:function(){},swiperChange:function(t){var n=this;this.tempFilePath="",this.did=this.dynInfo[t.detail.current].id,this.likeNumber=0,this.index=t.detail.current,this.uid=this.dynInfo[t.detail.current].uid,(0,a.checkIsCon)(this.dynInfo[t.detail.current].uid).then(function(i){i?n.dynInfo[t.detail.current].following=1:0==i&&(n.dynInfo[t.detail.current].following=0)}),this.getAllBullet(),t.detail.current+1==this.count&&(setTimeout(function(){e.showLoading({title:"加载中"}),n.loadFindDyn()},500),setTimeout(function(){e.hideLoading()},1500)),0==t.detail.current&&setTimeout(function(){n.findDyn()},2e3)},goChange:function(){this.item_id="slide1"},behaviour:function(){var n=this;e.showActionSheet({itemList:["取消關注","屏蔽用戶","舉報用戶"],success:function(t){if(0==t.tapIndex){if(0==n.dynInfo[n.index].following)return void e.showToast({icon:"none",title:"暫未關注該用戶"});e.showModal({title:"",content:"確定取消關注",confirmText:"確定",success:function(t){t.confirm?(0,a.concern)(2,n.uid).then(function(t){n.dynInfo[n.index].following=0}):t.cancel}})}if(1==t.tapIndex&&e.showModal({title:"",content:"屏蔽用戶",confirmText:"確定",success:function(t){t.confirm||t.cancel}}),2==t.tapIndex){var i={did:n.did,id:n.uid,name:n.dynInfo[n.index].name,avatar:n.dynInfo[n.index].portrait};e.showModal({title:"",content:"舉報用戶",confirmText:"確定",success:function(t){t.confirm?e.navigateTo({url:"/pages/msg/report?userInfo="+JSON.stringify(i)}):t.cancel}})}},fail:function(n){console.log(t(n.errMsg," at pages\\daily\\daily.vue:575"))}})}},filters:{stringifyDate:function(t){return t=Number(t),o.default.formatDate(t,!0)}},onBackPress:function(){e.switchTab({url:"/pages/main/main"})},onLoad:function(){this.cid=e.getStorageSync("USERS_KEY").id,this.findDyn(),this.ctx=e.createCanvasContext("mycanvas")}};n.default=u}).call(this,i("0de9")["default"],i("6e42")["default"])},c319:function(t,n,i){"use strict";var e=function(){var t=this,n=t.$createElement,i=(t._self._c,t.__map(t.commentInfo,function(n,i){var e=t._f("stringifyDate")(n.create_time);return{$orig:t.__get_orig(n),f0:e}}));t.$mp.data=Object.assign({},{$root:{l0:i}})},o=[];i.d(n,"a",function(){return e}),i.d(n,"b",function(){return o})},c4b0:function(t,n,i){"use strict";i.r(n);var e=i("b946"),o=i.n(e);for(var a in e)"default"!==a&&function(t){i.d(n,t,function(){return e[t]})}(a);n["default"]=o.a},d497:function(t,n,i){},eff3:function(t,n,i){}},[["8fd3","common/runtime","common/vendor"]]]);