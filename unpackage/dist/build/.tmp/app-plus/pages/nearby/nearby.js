(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/nearby/nearby"],{"1b6c":function(e,t,n){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=u(n("55c6")),r=(n("0a04"),n("9fe6"));function u(e){return e&&e.__esModule?e:{default:e}}var o=function(){return n.e("components/uni-tag/uni-tag").then(n.bind(null,"72b6"))},c=function(){return n.e("components/uni-popup/uni-popup").then(n.bind(null,"65e7"))},l=function(){return n.e("components/slider-range/index").then(n.bind(null,"8087"))},s=function(){return n.e("components/uni-search-bar/uni-search-bar").then(n.bind(null,"4233"))},f={components:{uniPopup:c,uniTag:o,SliderRange:l,uniSearchBar:s},data:function(){return{searchValue:"",tga:"",scope:10,longitude:"",latitude:"",nearbyInfo:[],remind:"",distance:[{inverted:!1,value:10},{inverted:!0,value:50},{inverted:!0,value:100}],arrangement:!1,character:[{inverted:!0,value:0},{inverted:!0,value:.5},{inverted:!0,value:1},{inverted:!0,value:"0.5偏0"},{inverted:!0,value:"0.5偏1"},{inverted:!0,value:"S"},{inverted:!0,value:"M"},{inverted:!0,value:"其它"}],ageRange:{max:70,min:18,rangevalue:[18,70],selectedvalue:[18,70]},weightRange:{max:200,min:40,rangevalue:[40,200],selectedvalue:[40,200]},heightRange:{max:220,min:150,rangevalue:[150,220],selectedvalue:[150,220]},flag:!1}},methods:{toUserInfo:function(t,n){e.navigateTo({url:"/pages/daily/userInfo?uid="+t+"&distance="+n})},updateLab:function(t){var n=e.getStorageSync("USERS_KEY").id;n==t&&e.navigateTo({url:"tga"})},search:function(){e.hideKeyboard();var t=this,n=e.getStorageSync("nearbyInfo"),i=new RegExp("("+t.searchValue.value+")","img"),r=[];n.forEach(function(e){i.test(e.name)&&r.push(e),i.test(e.lable)&&r.push(e)}),console.log(a(r," at pages\\nearby\\nearby.vue:256")),0!=r.length?(t.nearbyInfo=[],t.nearbyInfo=t.repeat(r)):e.showToast({icon:"none",title:"暫無搜索結果"})},repeat:function(e){for(var t=[],n=0;n<e.length;n++){for(var a=!0,i=0;i<t.length;i++)e[n].uid==t[i].uid&&(a=!1);a&&t.push(e[n])}return t},sliderChange1:function(e){this.ageRange.selectedvalue=e},sliderChange2:function(e){this.weightRange.selectedvalue=e},sliderChange3:function(e){this.heightRange.selectedvalue=e},reset:function(){this.distance=[{inverted:!1,value:10},{inverted:!0,value:50},{inverted:!0,value:100}],this.arrangement=!1,this.character=[{inverted:!0,value:0},{inverted:!0,value:.5},{inverted:!0,value:1},{inverted:!0,value:"0.5偏0"},{inverted:!0,value:"0.5偏1"},{inverted:!0,value:"S"},{inverted:!0,value:"M"},{inverted:!0,value:"其它"}],this.ageRange={max:70,min:18,rangevalue:[18,70],selectedvalue:[18,70]},this.weightRange={max:200,min:40,rangevalue:[40,200],selectedvalue:[40,200]},this.heightRange={max:220,min:150,rangevalue:[150,220],selectedvalue:[150,220]}},openPopup:function(){this.$refs.popup.open()},closePopup:function(){var t=this;this.remind="",this.nearbyInfo=[];var n=[];e.showLoading({title:"加载中"}),setTimeout(function(){e.hideLoading()},2e3),this.$refs.popup.close();for(var i=0;i<this.character.length;i++)this.character[i].inverted||n.push({type:"acctType",value:this.character[i].value});var u={rangesFilter:function(e,t){if(0===t.length)return e;var n=!0,a=!1,i=void 0;try{for(var r,u=function(){var t=r.value;e=e.filter(function(e){return e[t.type]>=t.min&&e[t.type]<=t.max})},o=t[Symbol.iterator]();!(n=(r=o.next()).done);n=!0)u()}catch(c){a=!0,i=c}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return e},choosesFilter:function(e,t){var n=[];if(0===t.length)n=e;else{var a=!0,i=!1,r=void 0;try{for(var u,o=function(){var t=u.value;n=n.concat(e.filter(function(e){return-1!==e[t.type].indexOf(t.value)}))},c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)o()}catch(l){i=!0,r=l}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}}return n}},o={ranges:[{type:"age",max:this.ageRange.selectedvalue[1],min:this.ageRange.selectedvalue[0]},{type:"stature",max:this.heightRange.selectedvalue[1],min:this.heightRange.selectedvalue[0]},{type:"weight",max:this.weightRange.selectedvalue[1],min:this.weightRange.selectedvalue[0]}],chooses:n};function c(e,t){for(var n in t)u.hasOwnProperty(n+"Filter")&&"function"===typeof u[n+"Filter"]&&(e=u[n+"Filter"](e,o[n]));return e}console.log(a(o," at pages\\nearby\\nearby.vue:435")),this.longitude&&0!=this.latitude.length?(0,r.checkNearbyPerson)(this.longitude,this.latitude,this.scope,this.tga).then(function(n){0==n.length&&(t.remind="附近暫無居民,請點擊右上角擴大範圍"),n.filter(function(e){(0,r.getInfo)(e.uid).then(function(t){var n=t.age+"/"+t.stature+"/"+t.weight+"/"+t.acctType;e.info=n,e.age=t.age,e.stature=t.stature,e.weight=t.weight,e.acctType=t.acctType}),(0,r.chaeckOnlineByUid)(e.uid).then(function(t){e.online=t})}),setTimeout(function(){var i=c(n,o);console.log(a(i," at pages\\nearby\\nearby.vue:470")),t.nearbyInfo=i,0==t.nearbyInfo.length&&(t.remind="暫無篩選結果"),e.setStorageSync("nearbyInfo",n),e.hideLoading()},200)}):this.remind="獲取定位權限失敗"},setDistance:function(e){for(var t=0;t<this.distance.length;t++)this.distance[t].inverted=!0;this.distance[e].inverted=!this.distance[e].inverted,this.scope=this.distance[e].value},setArrangement:function(){this.arrangement=!this.arrangement},setCharacter:function(e){this.character[e].inverted=!this.character[e].inverted},format:function(e){return e},format1:function(e){return e},format2:function(e){return e}},onNavigationBarButtonTap:function(){this.flag=!this.flag,this.flag?this.$refs.popup.open():this.$refs.popup.close()},onLoad:function(t){var n=this,a=this.$store.state.is_open_socket;a||i.default.connectSocketInit(),e.showLoading({title:"加載中"}),setTimeout(function(){e.hideLoading(),n.remind="獲取定位權限失敗"},4e3);var u=this;e.getLocation({type:"wgs84",success:function(t){u.longitude=t.longitude,u.latitude=t.latitude,(0,r.checkNearbyPerson)(u.longitude,u.latitude,u.scope,u.tga).then(function(t){0==t.length&&(u.remind="附近暫無居民,請點擊右上角擴大範圍"),t.filter(function(e){(0,r.getInfo)(e.uid).then(function(t){var n=t.age+"/"+t.stature+"/"+t.weight+"/"+t.acctType;e.info=n,e.age=t.age,e.stature=t.stature,e.weight=t.weight,e.acctType=t.acctType}),(0,r.chaeckOnlineByUid)(e.uid).then(function(t){e.online=t})}),setTimeout(function(){u.nearbyInfo=t,e.setStorageSync("nearbyInfo",t),e.hideLoading()},500)})},fail:function(){e.hideLoading(),u.remind="獲取定位權限失敗"}})},onPullDownRefresh:function(){var t=this;t.remind="",e.getLocation({type:"wgs84",success:function(n){t.longitude=n.longitude,t.latitude=n.latitude,(0,r.checkNearbyPerson)(t.longitude,t.latitude,t.scope,t.tga).then(function(n){n.filter(function(e){(0,r.getInfo)(e.uid).then(function(t){var n=t.age+"/"+t.stature+"/"+t.weight+"/"+t.acctType;e.info=n,e.age=t.age,e.stature=t.stature,e.weight=t.weight,e.acctType=t.acctType}),(0,r.chaeckOnlineByUid)(e.uid).then(function(t){e.online=t})}),setTimeout(function(){t.nearbyInfo=n,e.setStorageSync("nearbyInfo",n)},500)})},fail:function(){e.stopPullDownRefresh(),t.remind="獲取定位權限失敗"}}),setTimeout(function(){e.stopPullDownRefresh()},800)},onShow:function(){var t=this;e.getLocation({type:"wgs84",success:function(n){t.longitude=n.longitude,t.latitude=n.latitude,(0,r.checkNearbyPerson)(t.longitude,t.latitude,t.scope,t.tga).then(function(n){0==n.length&&(t.remind="附近暫無居民,請點擊右上角擴大範圍"),n.filter(function(e){(0,r.getInfo)(e.uid).then(function(t){var n=t.age+"/"+t.stature+"/"+t.weight+"/"+t.acctType;e.info=n,e.age=t.age,e.stature=t.stature,e.weight=t.weight,e.acctType=t.acctType}),(0,r.chaeckOnlineByUid)(e.uid).then(function(t){e.online=t})}),setTimeout(function(){t.nearbyInfo=n,e.setStorageSync("nearbyInfo",n),e.hideLoading()},500)})},fail:function(){e.hideLoading(),t.remind="獲取定位權限失敗"}})}};t.default=f}).call(this,n("6e42")["default"],n("0de9")["default"])},"2c3f":function(e,t,n){"use strict";var a=n("f9bb"),i=n.n(a);i.a},"542f":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=(e._self._c,e.__map(e.nearbyInfo,function(t,n){var a=e._f("toFixed")(t.scope,2);return{$orig:e.__get_orig(t),f0:a}}));e.$mp.data=Object.assign({},{$root:{l0:n}})},i=[];n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i})},"77d8":function(e,t,n){"use strict";n.r(t);var a=n("542f"),i=n("cf8a");for(var r in i)"default"!==r&&function(e){n.d(t,e,function(){return i[e]})}(r);n("2c3f");var u=n("2877"),o=Object(u["a"])(i["default"],a["a"],a["b"],!1,null,"1b36fc2c",null);t["default"]=o.exports},cf8a:function(e,t,n){"use strict";n.r(t);var a=n("1b6c"),i=n.n(a);for(var r in a)"default"!==r&&function(e){n.d(t,e,function(){return a[e]})}(r);t["default"]=i.a},eb6e:function(e,t,n){"use strict";(function(e){n("cbab"),n("921b");a(n("66fd"));var t=a(n("77d8"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},f9bb:function(e,t,n){}},[["eb6e","common/runtime","common/vendor"]]]);