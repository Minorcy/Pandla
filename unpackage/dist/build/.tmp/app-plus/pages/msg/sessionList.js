(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/msg/sessionList"],{"1cc0":function(t,s,e){"use strict";var n=e("2966"),i=e.n(n);i.a},2966:function(t,s,e){},a90b:function(t,s,e){"use strict";(function(t){e("cbab"),e("921b");n(e("66fd"));var s=n(e("ffae"));function n(t){return t&&t.__esModule?t:{default:t}}t(s.default)}).call(this,e("6e42")["createPage"])},b9e4:function(t,s,e){"use strict";e.r(s);var n=e("d5a2"),i=e.n(n);for(var o in n)"default"!==o&&function(t){e.d(s,t,function(){return n[t]})}(o);s["default"]=i.a},cc9d:function(t,s,e){"use strict";var n=function(){var t=this,s=t.$createElement,e=(t._self._c,t.__map(t.sessionlist,function(s,e){var n=t._f("dateFormat")(s.time);return{$orig:t.__get_orig(s),f0:n}}));t.$mp.data=Object.assign({},{$root:{l0:e}})},i=[];e.d(s,"a",function(){return n}),e.d(s,"b",function(){return i})},d5a2:function(t,s,e){"use strict";(function(t,n){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var i=a(e("e9e9")),o=(a(e("d0a7")),a(e("7c39"))),u=e("2f62"),r=e("9fe6");function a(t){return t&&t.__esModule?t:{default:t}}function c(t){for(var s=1;s<arguments.length;s++){var e=null!=arguments[s]?arguments[s]:{},n=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.forEach(function(s){l(t,s,e[s])})}return t}function l(t,s,e){return s in t?Object.defineProperty(t,s,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[s]=e,t}var g=function(){return e.e("components/uni-swipe-action/uni-swipe-action").then(e.bind(null,"a84a"))},f=function(){return e.e("components/uni-badge/uni-badge").then(e.bind(null,"1426"))},h={data:function(){return{delSessionId:null,options:[{text:"刪除",style:{backgroundColor:"#dd524d"}}],targetId:"",showDatas:[],convrList:"",systemTime:"",systemShow:!0,sessionlist:[],msgNum:""}},components:{uniSwipeAction:g,uniBadge:f},computed:{connNum:function(){if(!this.$store.state.pushMsg)return"0";if(0==this.$store.state.pushMsg.pushConnMsg.length)return"0";var t=this.$store.state.pushMsg.pushConnMsg.filter(function(t){return"1"==t.status});return t=t.length,t.toString()},fnasNum:function(){if(!this.$store.state.pushMsg)return"0";if(0==this.$store.state.pushMsg.pushFansMsg.length)return"0";var t=this.$store.state.pushMsg.pushFansMsg.filter(function(t){return"1"==t.status});return t=t.length,t.toString()},likeNum:function(){if(!this.$store.state.pushMsg)return"0";if(0==this.$store.state.pushMsg.pushLikeMsg.length)return"0";var t=this.$store.state.pushMsg.pushLikeMsg.filter(function(t){return"1"==t.status});return t=t.length,t.toString()},systemList:function(){var t=this;if(!this.$store.state.pushMsg)return"0";var s=[];s=this.$store.state.pushMsg.pushSystemMsg.filter(function(t){return"0"==t.isRed});var e=s.length,n=[];return n=this.$store.state.pushMsg.pushSystemMsg,n.unread=e,""==s?n:(0!=e&&(s.unread=e),t.systemShow=!0,s)}},methods:c({enterChat:function(s,e){t.navigateTo({url:"/pages/msg/chat?id="+s}),this.sessionlist[e].lastMsgShow=0},toSystem:function(){t.navigateTo({url:"./news/system"})},queryInfo:function(t){(0,r.getInfo)(t).then(function(t){return t})},bindClick:function(s,e){this.sessionlist=JSON.parse(JSON.stringify(this.sessionlist)),console.log(n(this.sessionlist," at pages\\msg\\sessionList.vue:217")),this.sessionlist.splice(e,1),t.setStorageSync("updateSessionList",this.sessionlist)},deleteSystem:function(){this.systemShow=!1},pickerChange:function(t){console.log(n("picker发送选择改变，携带值为："+t.target.value," at pages\\msg\\sessionList.vue:225"))},toTset:function(){t.navigateTo({url:"test"})},toReceive:function(){t.navigateTo({url:"Receive"})},toConnMsg:function(){t.navigateTo({url:"./news/connMsg"})},toFans:function(){t.navigateTo({url:"./news/fansMsg"})},toLikeMsg:function(){t.navigateTo({url:"./news/likeMsg"})},deleteAllLocalMsgsDone:function(t,s){console.log(n(t," at pages\\msg\\sessionList.vue:253")),console.log(n(s," at pages\\msg\\sessionList.vue:254")),console.log(n("删除所有本地消息"+(t?"失败":"成功")," at pages\\msg\\sessionList.vue:255"))}},(0,u.mapActions)(["searchUsers","getConnMsg","getFansMsg","getLikeMsg"])),onPullDownRefresh:function(){this.$store.dispatch("getConnMsg"),this.$store.dispatch("getFansMsg"),this.$store.dispatch("getLikeMsg"),setTimeout(function(){t.stopPullDownRefresh()},800)},onNavigationBarButtonTap:function(){var s=this;t.showActionSheet({itemList:["忽略未讀提醒","清空聊天列表","提醒設置"],success:function(e){console.log(n("选中了第"+e.tapIndex+"个按钮"," at pages\\msg\\sessionList.vue:273")),2==e.tapIndex&&t.navigateTo({url:"/pagesA/settingChat/settingChat"}),0==e.tapIndex&&t.showModal({title:"",content:"確定忽略未讀提醒",confirmText:"確定",success:function(e){e.confirm?(s.msgNum="0",s.sessionlist.filter(function(t){t.lastMsgShow=0}),t.setStorageSync("updateSessionList",s.sessionlist)):e.cancel}}),1==e.tapIndex&&t.showModal({title:"",content:"確定清空聊天列表",confirmText:"確定",cancelColor:"#007AFF",confirmColor:"#007AFF",success:function(e){e.confirm?(s.msgNum="0",s.sessionlist=[],t.setStorageSync("updateSessionList",[])):e.cancel&&console.log(n("用户点击取消"," at pages\\msg\\sessionList.vue:310"))}})},fail:function(t){console.log(n(t.errMsg," at pages\\msg\\sessionList.vue:317"))}})},onLoad:function(){var s=this,e=o.default.state.noDisturbingList;if(this.systemTime=i.default.formatDate(new Date,!0),this.sessionlist=t.getStorageSync("updateSessionList"),this.sessionlist){s.sessionlist.filter(function(t){t.disturbing=!1,e.indexOf(t.from.id)>-1&&(t.lastMsgShow=0,t.disturbing=!0)});for(var n=0,u=0;u<s.sessionlist.length;u++)n+=Number(s.sessionlist[u].lastMsgShow);s.msgNum=n.toString()}t.$on("updateSessionList",function(t){var e=o.default.state.noDisturbingList,n=JSON.parse(JSON.stringify(t));n.filter(function(t){t.disturbing=!1,e.indexOf(t.from.id)>-1&&(t.lastMsgShow=0,t.disturbing=!0)});for(var i=0,u=0;u<n.length;u++)i+=Number(n[u].lastMsgShow);s.msgNum=i.toString(),setTimeout(function(){s.sessionlist=n},500)})},onShow:function(){t.removeTabBarBadge({index:1})},filters:{dateFormat:function(t){return t=Number(t),i.default.formatDate(t,!0)}}};s.default=h}).call(this,e("6e42")["default"],e("0de9")["default"])},ffae:function(t,s,e){"use strict";e.r(s);var n=e("cc9d"),i=e("b9e4");for(var o in i)"default"!==o&&function(t){e.d(s,t,function(){return i[t]})}(o);e("1cc0");var u=e("2877"),r=Object(u["a"])(i["default"],n["a"],n["b"],!1,null,"a21bb838",null);s["default"]=r.exports}},[["a90b","common/runtime","common/vendor"]]]);