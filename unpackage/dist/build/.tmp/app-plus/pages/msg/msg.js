(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/msg/msg"],{3205:function(t,e,n){"use strict";(function(t,s){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=u(n("d3df")),a=(u(n("9d96")),n("2f62")),i=n("0be9");function u(t){return t&&t.__esModule?t:{default:t}}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},s=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),s.forEach(function(e){c(t,e,n[e])})}return t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l=function(){return n.e("components/uni-swipe-action/uni-swipe-action").then(n.bind(null,"c2f2"))},g=function(){return n.e("components/uni-badge/uni-badge").then(n.bind(null,"d18a"))},f={data:function(){return{delSessionId:null,options:[{text:"刪除",style:{backgroundColor:"#dd524d"}}],targetId:"",showDatas:[],convrList:"",systemTime:""}},components:{uniSwipeAction:l,uniBadge:g},computed:{msgNum:function(){if(!this.$store.state.pushMsg)return"0";var t=0,e=(this.$store.state.sessionlist.filter(function(e){t+=e.unread}),this.$store.state.pushMsg.pushSystemMsg.filter(function(t){return"0"==t.isRed}));return e=e.length,t=Number(t)+Number(e),t.toString()},connNum:function(){if(!this.$store.state.pushMsg)return"0";if(0==this.$store.state.pushMsg.pushConnMsg.length)return"0";var t=this.$store.state.pushMsg.pushConnMsg.filter(function(t){return"1"==t.status});return t=t.length,t.toString()},fnasNum:function(){if(!this.$store.state.pushMsg)return"0";if(0==this.$store.state.pushMsg.pushFansMsg.length)return"0";var t=this.$store.state.pushMsg.pushFansMsg.filter(function(t){return"1"==t.status});return t=t.length,t.toString()},likeNum:function(){if(!this.$store.state.pushMsg)return"0";if(0==this.$store.state.pushMsg.pushLikeMsg.length)return"0";var t=this.$store.state.pushMsg.pushLikeMsg.filter(function(t){return"1"==t.status});return t=t.length,t.toString()},systemList:function(){if(!this.$store.state.pushMsg)return"0";var t=[];t=this.$store.state.pushMsg.pushSystemMsg.filter(function(t){return"0"==t.isRed});var e=t.length,n=[];return n=this.$store.state.pushMsg.pushSystemMsg,n.unread=e,""==t?n:(0!=e&&(t.unread=e),t)},userInfos:function(){return this.$store.state.userInfos},myInfo:function(){return this.$store.state.myInfo},myPhoneId:function(){return"".concat(this.$store.state.userUID)},sessionlist:function(){var t=this,e=this.$store.state.sessionlist.filter(function(e){if(e.name="",e.avatar="","p2p"===e.scene){var n=null;if(e.to===t.myPhoneId)return!1;n=t.userInfos[e.to],n&&(e.name=o.default.getFriendAlias(n),e.avatar=n.avatar)}var s=e.lastMsg||{};return"text"===s.type?e.lastMsgShow=s.text||"":"custom"===s.type?e.lastMsgShow=o.default.parseCustomMsg(s):"team"===s.scene&&"notification"===s.type?e.lastMsgShow=o.default.generateTeamSysmMsg(s):o.default.mapMsgType(s)?e.lastMsgShow="[".concat(o.default.mapMsgType(s),"]"):e.lastMsgShow="",e.updateTime&&(e.updateTimeShow=o.default.formatDate(e.updateTime,!0)),e});return e}},methods:r({enterChat:function(e){t.navigateTo({url:"chat?id="+e,animationType:"pop-in",animationDuration:500,success:function(t){},fail:function(){},complete:function(){}})},toSystem:function(){t.navigateTo({url:"./news/system"})},queryInfo:function(t){(0,i.getInfo)(t).then(function(t){return t})},bindClick:function(t){console.log(s("用户点击刪除"," at pages\\msg\\msg.vue:275")),this.$store.dispatch("deleteSession",t)},deleteSystem:function(){},pickerChange:function(t){console.log(s("picker发送选择改变，携带值为："+t.target.value," at pages\\msg\\msg.vue:282"))},toTset:function(){t.navigateTo({url:"test"})},toReceive:function(){t.navigateTo({url:"Receive"})},toConnMsg:function(){t.navigateTo({url:"./news/connMsg"})},toFans:function(){t.navigateTo({url:"./news/fansMsg"})},toLikeMsg:function(){t.navigateTo({url:"./news/likeMsg"})},deleteAllLocalMsgsDone:function(t,e){console.log(s(t," at pages\\msg\\msg.vue:310")),console.log(s(e," at pages\\msg\\msg.vue:311")),console.log(s("删除所有本地消息"+(t?"失败":"成功")," at pages\\msg\\msg.vue:312"))}},(0,a.mapActions)(["searchUsers","getConnMsg","getFansMsg","getLikeMsg"])),onPullDownRefresh:function(){this.$store.dispatch("connect"),this.$store.dispatch("getConnMsg"),this.$store.dispatch("getFansMsg"),this.$store.dispatch("getLikeMsg"),setTimeout(function(){t.stopPullDownRefresh()},800)},onNavigationBarButtonTap:function(){var e=this;t.showActionSheet({itemList:["忽略未讀提醒","清空聊天列表","提醒設置"],success:function(n){console.log(s("选中了第"+n.tapIndex+"个按钮"," at pages\\msg\\msg.vue:331")),2==n.tapIndex&&t.navigateTo({url:"/pagesA/settingChat/settingChat"}),0==n.tapIndex&&t.showModal({title:"",content:"確定忽略未讀提醒",confirmText:"確定",success:function(t){t.confirm?console.log(s("用户点击确定"," at pages\\msg\\msg.vue:344")):t.cancel&&console.log(s("用户点击取消"," at pages\\msg\\msg.vue:346"))}}),1==n.tapIndex&&t.showModal({title:"",content:"確定清空聊天列表",confirmText:"確定",success:function(t){t.confirm?(console.log(s("用户点击确定"," at pages\\msg\\msg.vue:358")),e.$store.state.nim.deleteAllLocalMsgs({done:e.deleteAllLocalMsgsDone})):t.cancel&&console.log(s("用户点击取消"," at pages\\msg\\msg.vue:363"))}})},fail:function(t){console.log(s(t.errMsg," at pages\\msg\\msg.vue:370"))}})},onLoad:function(){this.systemTime=o.default.formatDate(new Date,!0)},onShow:function(){t.removeTabBarBadge({index:1}),this.sessionlist.length&&this.$store.dispatch("resetCurrSession")}};e.default=f}).call(this,n("6e42")["default"],n("0de9")["default"])},"518a":function(t,e,n){"use strict";var s=n("e393"),o=n.n(s);o.a},"655a":function(t,e,n){"use strict";n.r(e);var s=n("3205"),o=n.n(s);for(var a in s)"default"!==a&&function(t){n.d(e,t,function(){return s[t]})}(a);e["default"]=o.a},9521:function(t,e,n){"use strict";(function(t){n("274e"),n("921b");s(n("66fd"));var e=s(n("dd1d"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("6e42")["createPage"])},d933:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement;t._self._c},o=[];n.d(e,"a",function(){return s}),n.d(e,"b",function(){return o})},dd1d:function(t,e,n){"use strict";n.r(e);var s=n("d933"),o=n("655a");for(var a in o)"default"!==a&&function(t){n.d(e,t,function(){return o[t]})}(a);n("518a");var i=n("2877"),u=Object(i["a"])(o["default"],s["a"],s["b"],!1,null,"24eae460",null);e["default"]=u.exports},e393:function(t,e,n){}},[["9521","common/runtime","common/vendor"]]]);