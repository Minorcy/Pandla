(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/wm-poster/wm-poster"],{"30fd":function(t,e,n){"use strict";n.r(e);var r=n("4362"),i=n("b69c");for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);var c=n("2877"),l=Object(c["a"])(i["default"],r["a"],r["b"],!1,null,null,null);e["default"]=l.exports},4362:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement;t._self._c},i=[];n.d(e,"a",function(){return r}),n.d(e,"b",function(){return i})},b04d:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=a(n("a34a"));function a(t){return t&&t.__esModule?t:{default:t}}function c(t,e,n,r,i,a,c){try{var l=t[a](c),u=l.value}catch(o){return void n(o)}l.done?e(u):Promise.resolve(u).then(r,i)}function l(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var a=t.apply(e,n);function l(t){c(a,r,i,l,u,"next",t)}function u(t){c(a,r,i,l,u,"throw",t)}l(void 0)})}}var u={name:"wm-poster",props:{CanvasID:{Type:String,default:"PosterCanvas"},imgSrc:{Type:String,default:""},QrSrc:{Type:String,default:""},Title:{Type:String,default:""},TitleColor:{Type:String,default:"#333333"},LineType:{Type:[String,Boolean],default:!0},PriceTxt:{Type:String,default:"99.99"},PriceColor:{Type:String,default:"#000000"},OriginalTxt:{Type:String,default:"199.99"},OriginalColor:{Type:String,default:"#b8b8b8"},Width:{Type:String,default:750},CanvasBg:{Type:String,default:"#ffffff"},Referrer:{Type:String,default:"潘多拉星球内測1.0歡迎您"},ViewDetails:{Type:String,default:"长按或扫描识别二维码"}},data:function(){return{canvasW:0,canvasH:0,canvasImgSrc:"",ctx:null}},methods:{OnCanvas:function(){var e=l(i.default.mark(function e(){var n,a,c,l,u,o,s,f,x,p,d,g,T;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t.showLoading({title:"生成海報中"}),r.ctx=t.createCanvasContext(r.CanvasID,this),n=t.upx2px(r.Width),a=t.upx2px(30),c=t.upx2px(150),l=0,e.next=6,r.getImageInfo({imgSrc:r.imgSrc});case 6:return u=e.sent,e.next=9,r.getImageInfo({imgSrc:r.QrSrc});case 9:o=e.sent,s=[u.width,u.height],f=[o.width,o.height],x=n-2*a,s[0]!=x&&(s[1]=Math.floor(x/s[0]*s[1]),s[0]=x),f[0]!=c&&(f[1]=Math.floor(c/f[0]*f[1]),f[0]=c),r.canvasW=n,r.canvasH=s[1]+f[1]+128,r.ctx.setFillStyle(r.CanvasBg),r.ctx.fillRect(0,0,n,r.canvasH),r.ctx.drawImage(u.path,a,a,s[0],s[1]),r.ctx.setFontSize(t.upx2px(28)),r.ctx.setFillStyle(r.TitleColor),p=0,d=s[1]+2*a+10,g=1,T=0;case 26:if(!(T<r.Title.length)){e.next=48;break}if(l+=r.ctx.measureText(r.Title[T]).width,!(l>s[0])){e.next=44;break}if(2!=g||!r.LineType){e.next=37;break}return r.ctx.fillText(r.Title.substring(p,T-8)+"...",a,d),l=0,p=T,g++,e.abrupt("break",48);case 37:r.ctx.fillText(r.Title.substring(p,T),a,d),l=0,d+=20,p=T,g++;case 42:e.next=45;break;case 44:T==r.Title.length-1&&(r.ctx.fillText(r.Title.substring(p,T+1),a,d),l=0);case 45:T++,e.next=26;break;case 48:l=a,d+=t.upx2px(60),1==g&&(d+=20),""!=r.PriceTxt&&(r.ctx.setFillStyle(r.PriceColor),r.ctx.setFontSize(t.upx2px(38)),r.ctx.fillText(r.PriceTxt,l,d),l+=r.ctx.measureText(r.PriceTxt).width+t.upx2px(10)),""!=r.PriceTxt&&""!=r.OriginalTxt&&(r.ctx.setFillStyle(r.OriginalColor),r.ctx.setFontSize(t.upx2px(24)),r.ctx.fillText(r.OriginalTxt,l,d)),r.ctx.strokeStyle=r.OriginalColor,r.ctx.moveTo(l,d-t.upx2px(10)),r.ctx.lineTo(l+r.ctx.measureText(r.OriginalTxt).width,d-t.upx2px(10)),r.ctx.stroke(),d+=t.upx2px(20),r.ctx.drawImage(o.path,s[0]-f[0]+a,d,f[0],f[1]),r.ctx.setFillStyle(r.TitleColor),r.ctx.setFontSize(t.upx2px(30)),r.ctx.fillText(r.Referrer,a,d+f[1]/2),r.ctx.setFillStyle(r.OriginalColor),r.ctx.setFontSize(t.upx2px(24)),r.ctx.fillText(r.ViewDetails,a,d+f[1]/2+20),setTimeout(function(){r.ctx.draw(!0,function(t){r.getNewImage()})},600);case 66:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),getImageInfo:function(){var e=l(i.default.mark(function e(n){var r;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=n.imgSrc,e.abrupt("return",new Promise(function(e,n){t.getImageInfo({src:r,success:function(t){e(t)},fail:function(t){n(t)}})}));case 2:case"end":return e.stop()}},e,this)}));function n(t){return e.apply(this,arguments)}return n}(),getNewImage:function(){t.canvasToTempFilePath({canvasId:r.CanvasID,quality:1,complete:function(e){t.hideLoading(),r.$emit("success",e)}},this)}},mounted:function(){r=this,r.OnCanvas()}};e.default=u}).call(this,n("6e42")["default"])},b69c:function(t,e,n){"use strict";n.r(e);var r=n("b04d"),i=n.n(r);for(var a in r)"default"!==a&&function(t){n.d(e,t,function(){return r[t]})}(a);e["default"]=i.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/wm-poster/wm-poster-create-component',
    {
        'components/wm-poster/wm-poster-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('6e42')['createComponent'](__webpack_require__("30fd"))
        })
    },
    [['components/wm-poster/wm-poster-create-component']]
]);                
